<!DOCTYPE html>
<html>

<head>
    <title>WebSocket Test</title>

    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css" />

    <script src="https://unpkg.com/vue@2/dist/vue.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
</head>

<body>
    <div id="app">
        <el-input placeholder="Please input" v-model="message"></el-input>
        <el-button type="primary" @click="send">send</el-button>
    </div>
</body>

<script>
    new Vue({
        el: "#app",
        data: {
            visible: false,
            message: "Hello",
        },
        methods: {
            send() {
                this.sendMessage(this.message);
            },
            sendMessage(message) {
                if (this.ws.readyState === WebSocket.OPEN) {
                    this.ws.send(message);
                }
            },
        },
        created() {
            this.ws = new WebSocket("ws://localhost:8080");

            this.ws.addEventListener("open", (event) => {
                console.log("WebSocket connection opened:", event);
                this.ws.send("Hello Server!");
            });

            this.ws.addEventListener("message", (event) => {
                console.log("Message from server:", event.data);
                this.messages.push(event.data);
            });
        },
    });
</script>

</html>